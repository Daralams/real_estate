<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="estate_property_view_search" model="ir.ui.view">
    <field name="name">estate.property.view</field>
    <field name="model">estate.property</field>
    <field name="arch" type="xml">
      <search string="Filter property by archived, inactive, status property and best offer">
        <field name="name" string="Name of Property" filter_domain="[('name', 'ilike', self)]"/>
        <field name="property_type_id" string="Type of Property"/>
        <field name="country_id"/>
        <field name="postcode" />
        <filter name="Include archived" string="Archived" domain="['|', ('active', '=', True), ('active', '=', False)]" />
        <separator/>
        <filter name="Archived" string="Inactive" domain="[('active', '=', False)]" />
        <separator/>
        <filter name="available" string="Available" domain="['|', ('state', '=', 'new'), ('state', '=', 'offer received')]" context="{'search_default_available': 1}"/>
        <filter name="offer_accepted_property" string="Offer Accepted Property" domain="[('state', '=', 'offer accepted')]" />
        <filter name="sold_property" string="Sold Property" domain="[('state', '=', 'sold')]" />
        <filter name="cancelled_property" string="Cancelled Property" domain="[('state', '=', 'cancelled')]" />
        <separator/>
        <filter name="available_date" string="Available Date" date="available_date" />
      </search>
    </field>
  </record>
  <record id="estate_property_view_tree" model="ir.ui.view">
    <field name="name">estate.property.view</field>
    <field name="model">estate.property</field>
    <field name="arch" type="xml">
      <list string="Properties" decoration-success="state in ('offer accepted', 'sold')" decoration-danger="state == 'cancelled'">
        <field name="name" />
        <field name="property_type_id" />
        <field name="postcode" />
        <field name="tags" widget="many2many_tags"/>
        <field name="bedrooms" />
        <field name="living_area" />
        <field name="expected_price" />
        <field name="sell_price" />
      </list>
    </field>
  </record>
  <record id="estate_property_view_form" model="ir.ui.view">
    <field name="name">estate.property.view</field>
    <field name="model">estate.property</field>
    <field name="arch" type="xml">
      <form string="Properties">
        <header>
          <button name="action_sold" type="object" string="Sold" class="btn btn-primary" invisible="state == 'cancelled' or state == 'sold'"/>
          <button name="action_cancel" type="object" string="Cancel" invisible="state == 'sold' or state == 'cancelled'"/>
          <button type="action" name="%(estate_property_type_action)d" string="Type property"/>
          <field name="state" widget="statusbar" statusbar_visible="new,offer received,offer accepted,sold"/>
        </header>
        <sheet>
          <div class="oe-title" name="property_templete_name">
            <label for="name" id="property_templete_name"/>
            <h1>
              <field name="name" placeholder="e.g. Property example" class="d-block" decoration-success="state in ('offer accepted', 'sold')" decoration-danger="state == 'cancelled'"/>
            </h1>
          </div>
          <group>
            <group>
              <field name="tags" widget="many2many_tags"/>
              <field name="property_type_id" />
              <field name="country_id" />
              <field name="postcode" />
              <field name="available_date" />
            </group>
            <group>
              <field name="expected_price"/>
              <field name="best_offer" />
              <field name="sell_price" readonly="1"/>
              <field name="active" />
            </group>
          </group>
          <notebook>
            <page name="description" string="Description">
              <group>
                <field name="description" />
                <field name="bedrooms" />
                <field name="living_area" />
                <field name="facades" />
                <field name="garage" />
                <field name="garden" />
                <field name="garden_area" invisible="garden == False"/>
                <field name="garden_orientation" invisible="garden == False"/>
                <field name="total_area"/>
              </group>
            </page>
            <page name="offers" string="Offers">
              <group>
                <field name="offer_ids" mode="list,kanban" nolabel="1" colspan="2" readonly="state in ('offer accepted', 'sold', 'cancelled')">
                  <list string="Offers" editable="bottom" decoration-success="status == 'accepted'"  decoration-danger="status == 'refused'">
                    <field name="price" />
                    <field name="partner_id" widget="many2one_avatar_user"/>
                    <field name="validity"/>
                    <field name="date_deadline"/>
                    <button name="accept_offer" type="object" class="btn btn-success" icon="fa-check" invisible="offer_state == 'done'"/>
                    <button name="refused_offer" type="object" class="btn btn-danger" icon="fa-times" invisible="offer_state == 'done'"/>
                    <field name="status" readonly="1"/>
                  </list>
                </field>
              </group>
            </page>
            <page name="other-info" string="Other Info">
              <group>
                <field name="salesman" widget="many2one_avatar_user"/>
                <field name="buyer" widget="many2one_avatar_user" readonly="1"/>
              </group>
            </page>
          </notebook>
        </sheet>
      </form>
    </field>
  </record>
  <record id="estate_property_action" model="ir.actions.act_window">
    <field name="name">Properties</field>
    <field name="res_model">estate.property</field>
    <field name="view_mode">list,form</field>
    <field name="domain">[]</field>
    <field name="context">{'search_default_available': 1}</field>
    <field name="help" type="html">
      <p class="o_view_nocontent_smiling_face">Manage properties here</p>
    </field>
  </record>
</odoo>